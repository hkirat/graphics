<script src = "./p5.js">
</script>
<script>

var WIDTH = 800;
var HEIGHT = 600;
var DEPTH = 900;
var GRAVITY = 9.8;
function setup(){
  createCanvas(WIDTH, HEIGHT, WEBGL);
}
var ball1 = new Ball(30, .9, 9.8); 

function draw(){
  	background(200);
  	ball1.updateY();
  	ball1.updateZ();
  	ball1.updateX();
  	ball1.translate();
  	ball1.render();
  	ball1.antiTranslate();
}

function Ball(radius, e, gravity) {
	this.r = radius;
	this.e = e;
	this.ex = 1.1;
	this.ez = e;
	this.g = gravity || GRAVITY;
	this.x = 0;
	this.y = 0;
	this.z = 0;
	this.vx = 0;
	this.gx = gravity||GRAVITY;
	this.vz = 0;
	this.gz  = -1 * (gravity||GRAVITY);
	this.v = 0;
	this.prevTime = -1;
	this.prevTime2 = -1;
	this.prevTime3 = -1;
	this.collided = false;
}

Ball.prototype.translate = function() {
	translate(this.x, this.y, this.z);
}

Ball.prototype.antiTranslate = function() {
	translate(-1 * this.x, -1 * this.y, -this.z)
}

Ball.prototype.render = function() {
	sphere(this.r);
}

Ball.prototype.updateY = function() {
	if(this.prevTime == -1) {

	} else {
		this.v += (this.g * (Date.now() - this.prevTime))/100;
		this.y += (this.v * (Date.now() - this.prevTime))/100;
	}
	if(this.y + this.r > HEIGHT/2 && !this.collided) {
		this.v = this.e * this.v * -1;
		this.y = HEIGHT/2 - this.r - 3 ;
		this.collided = true;
		if(Math.abs(this.v)<10) {
			this.v = 0;
			this.g = 0;
		}
	} else {
		this.collided = false;
	}
	this.prevTime = Date.now();
}

Ball.prototype.updateX = function() {
	if(this.prevTime2 == -1) {

	} else {
		this.vx += (this.gx * (Date.now() - this.prevTime2))/100;
		this.x += (this.vx * (Date.now() - this.prevTime2))/100;
	}
	if(this.x + this.r > WIDTH/2 && !this.collided) {
		this.vx = this.ex * this.vx * -1;
		this.x = WIDTH/2 - this.r - 3 ;
		this.collided = true;
		if(Math.abs(this.vx)<10) {
			this.vx = 0;
			this.gx = 0;
		}
	} else {
		this.collided = false;
	}
	this.prevTime2 = Date.now();
}

Ball.prototype.updateZ = function() {
	console.log(this.z);
	console.log(this.vz);
	if(this.prevTime3 == -1) {

	} else {
		this.vz += (this.gz * (Date.now() - this.prevTime3))/100;
		this.z += (this.vz * (Date.now() - this.prevTime3))/100;
	}
	if(this.z - this.r < -1 * DEPTH/2 && !this.collided) {
		this.vz = this.ez * this.vz * -1;
		this.z = -1 * DEPTH/2 + this.r + 3 ;
		this.collided = true;
		if(Math.abs(this.vz) < 10) {
			this.vz = 0;
			this.gz = 0;
		}
	} else {
		this.collided = false;
	}
	this.prevTime3 = Date.now();
}
</script>